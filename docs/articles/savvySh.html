<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>savvySh: Shrinkage Methods for Linear Regression Estimation â€¢ savvySh</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.2.1/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.2.1/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="savvySh: Shrinkage Methods for Linear Regression Estimation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">savvySh</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/savvySh.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>savvySh: Shrinkage Methods for Linear Regression Estimation</h1>
            
      

      <div class="d-none name"><code>savvySh.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>savvySh</code> is an R package that implements a suite of
shrinkage estimators for multivariate linear regression. The motivation
for shrinkage estimation originates from Steinâ€™s paradox, which shows
that it is possible to improve on the classical <em>Ordinary Least
Squares (OLS)</em> estimator when estimating multiple parameters
simultaneously. This improvement is achieved by introducing structured
bias that reduces variance, yielding estimators with smaller overall
<em>Mean Squared Error (MSE)</em>.</p>
<p>The <code>savvySh</code> package provides a unified interface to four
shrinkage strategies, each designed to improve prediction accuracy and
estimation stability in finite samples. These methods do not require
cross-validation or tuning parameter selection, with the exception of
the <em>Shrinkage Ridge Regression (SRR)</em>, for which the shrinkage
intensity is chosen by minimizing an explicit MSE criterion.</p>
<p>The package is particularly suited for high-dimensional settings or
cases where the design matrix exhibits near multicollinearity. Empirical
results in both simulation and real data settings show that at least one
of the shrinkage estimators consistently performs as well as or better
than OLS, and in many cases leads to substantial improvements,
especially when applied to generalized linear models.</p>
<p>For more details, please see:</p>
<p>Asimit, V., Cidota, M. A., Chen, Z., &amp; Asimit, J. (2025). <a href="https://openaccess.city.ac.uk/id/eprint/35005/" class="external-link">Slab and Shrinkage
Linear Regression Estimation</a></p>
<p><strong>Main features</strong>: <code>savvySh</code> provides four
classes of shrinkage estimators for linear regression:</p>
<ul>
<li><p><a href="#multiplicative-shrinkage">Multiplicative Shrinkage:</a>
Modifies OLS estimates by applying data-driven multiplicative factors.
This includes the <em>Stein estimator (St)</em>, <em>Diagonal Shrinkage
(DSh)</em>, and the more general <em>Shrinkage estimator (Sh)</em> that
solves a <em>Sylvester equation</em>.</p></li>
<li><p><a href="#slab-regression">Slab Regression:</a> Adds a quadratic
penalty to shrink the coefficients in specific directions. The
<em>Simple Slab Regression (SR)</em> penalizes along a fixed direction,
and the <em>Generalized Slab Regression (GSR)</em> allows penalties
along multiple directions, typically aligned with the data
structure.</p></li>
<li><p><a href="#linear-shrinkage">Linear Shrinkage:</a> Combines the
OLS estimator (through the origin) with a target that assumes
uncorrelated covariates. This method is designed for standardized data
and avoids estimating the intercept.</p></li>
<li><p><a href="#shrinkage-ridge-regression">Shrinkage Ridge
Regression:</a> Improves on <em>Ridge Regression (RR)</em> by shrinking
toward a diagonal matrix with equal entries, balancing the sample
structure with a stable target.</p></li>
</ul>
<p><strong>Inputs</strong>: The primary inputs to <code>savvySh</code>
are similar to those of a regression function:</p>
<ul>
<li><p><code>x</code>: The design matrix (predictor matrix) of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n\times p</annotation></semantics></math>.</p></li>
<li><p><code>y</code>: The response vector of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>.</p></li>
<li><p><code>model_class</code>: The shrinkage method to use (one of
<code>"Multiplicative"</code>, <code>"Slab"</code>,
<code>"Linear"</code>, or <code>"ShrinkageRR"</code>).</p></li>
<li><p>Additional method-specific parameters (e.g., include
<code>Sh</code>or not), with sensible defaults or automatic selection if
not provided.</p></li>
</ul>
<p><strong>Output</strong>: The output of <code>savvySh</code> is a list
containing several elements:</p>
<ul>
<li><p><code>call</code>: the original function call.</p></li>
<li><p><code>model</code>: The data frame of <code>y</code> and
<code>x</code> used in the analysis.</p></li>
<li><p><code>optimal_lambda</code>: the penalty parameter used (if
applicable).</p></li>
<li><p><code>model_class</code>: the shrinkage method used
(e.g.,<code>"Multiplicative"</code>, <code>"Slab"</code>,
<code>"Linear"</code>, or <code>"ShrinkageRR"</code>).</p></li>
<li><p><code>coefficients</code>: A list of estimated coefficients for
each applicable estimator for chosen <code>model_class</code>.</p></li>
<li><p>Additional method-specific diagnostics (e.g., fitted values and
predicted MSE).</p></li>
</ul>
<p>This vignette provides an overview of the methods implemented in
<code>savvySh</code> and demonstrates how to use them on <a href="#simulation-examples">simulated data</a> and <a href="#real-data-analysis">real data</a>. We begin with a theoretical
overview of each shrinkage class, then walk through simulation examples
that illustrate how to apply <code>savvySh</code> for each method.</p>
<hr>
</div>
<div class="section level2">
<h2 id="theoretical-overview">Theoretical Overview<a class="anchor" aria-label="anchor" href="#theoretical-overview"></a>
</h2>
<p>The <code>savvySh</code> function encompasses four shrinkage
strategies for linear regression. All these methods aim to improve
predictive accuracy and interpretability by trading a small amount of
bias for a larger reduction in variance. Below we briefly summarize the
theoretical background of each method.</p>
<p>Consider a response vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ²</mi><mo>âˆˆ</mo><msup><mi>â„œ</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{y} \in \Re^n</annotation></semantics></math>
and a predictor matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ—</mi><mo>âˆˆ</mo><msup><mi>â„œ</mi><mrow><mi>n</mi><mo>Ã—</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} \in \Re^{n \times (p+1)}</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><annotation encoding="application/x-tex">\widehat{\boldsymbol{\beta}}^{\text{OLS}}</annotation></semantics></math>
be the OLS estimator of the coefficient vector, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î£</mi><mo>=</mo><msup><mi>ğ—</mi><mi>âŠ¤</mi></msup><mi>ğ—</mi></mrow><annotation encoding="application/x-tex">\Sigma = \mathbf{X}^\top \mathbf{X}</annotation></semantics></math>
the Gram matrix of the design.</p>
<div class="section level3">
<h3 id="multiplicative-shrinkage">Multiplicative Shrinkage<a class="anchor" aria-label="anchor" href="#multiplicative-shrinkage"></a>
</h3>
<p>This class of estimators modifies the OLS solution by multiplying it
with a matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\mathbf{D}</annotation></semantics></math>,
yielding the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mi>ğƒ</mi><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\widehat{\boldsymbol{\beta}} = \mathbf{D} \widehat{\boldsymbol{\beta}}^{OLS}</annotation></semantics></math>.
The goal is to choose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\mathbf{D}</annotation></semantics></math>
to minimize the MSE of the resulting estimator. While earlier work such
as <a href="https://www.jstor.org/stable/1268658" class="external-link">Hocking et
al.Â (1976)</a> focused on the case where the design matrix is in
canonical form (orthonormal), our framework generalizes these results to
arbitrary design matrices without requiring that assumption. Common
choices for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\mathbf{D}</annotation></semantics></math>
include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Stein Estimator (St):</strong> The St estimator shrinks all
coefficients uniformly by a single factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msup><mi>a</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{a^*}</annotation></semantics></math>:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">St</mtext></msup><mo>=</mo><mover><msup><mi>a</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><mo>,</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="1.0em"></mspace><mover><msup><mi>a</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><mo>=</mo><mfrac><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo>+</mo><mover><mrow><mtext mathvariant="normal">MSE</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">Ì‚</mo></mover></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{\text{St}} = \widehat{a^*} \widehat{\boldsymbol{\beta}}^{\text{OLS}}, \quad \text{where} \quad
\widehat{a^*} = \frac{\left(\widehat{\boldsymbol\beta}^{OLS}\right)^T\widehat{\boldsymbol\beta}^{OLS}}{\left(\widehat{\boldsymbol\beta}^{OLS}\right)^T\widehat{\boldsymbol\beta}^{OLS} + \widehat{\text{MSE}\left(\widehat{\boldsymbol{\beta}}^{\text{OLS}}\right)}}.
</annotation></semantics></math></p>
<p>This corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mi>a</mi><msub><mi>ğˆ</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{D} = a \mathbf{I}_{p+1}</annotation></semantics></math>.
It reduces variance by scaling all coefficients equally.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Diagonal Shrinkage Estimator (DSh):</strong> Extending the
St estimator, DSh applies a separate shrinkage factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msubsup><mi>b</mi><mi>k</mi><mo>*</mo></msubsup><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{b_k^*}</annotation></semantics></math>
to each coefficient:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">DSh</mtext></msup><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><msup><mi>ğ›</mi><mo mathvariant="bold">*</mo></msup><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="1.0em"></mspace><mover><msubsup><mi>b</mi><mi>k</mi><mo>*</mo></msubsup><mo accent="true">Ì‚</mo></mover><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mi>k</mi><mtext mathvariant="normal">OLS</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mi>k</mi><mtext mathvariant="normal">OLS</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mover><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo accent="true">Ì‚</mo></mover><msub><mi>Ïƒ</mi><mi>k</mi></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{\text{DSh}} = \text{diag}\left(\widehat{\mathbf{b^*}}\right), \quad 
\text{where} \quad
\widehat{b_k^*} = \frac{\left(\widehat{\beta}_k^{\text{OLS}}\right)^2}{\left(\widehat{\beta}_k^{\text{OLS}}\right)^2 + \widehat{\sigma^2} \sigma_k}.
</annotation></semantics></math></p>
<p>This corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{D} = \text{diag}\left(\mathbf{b}\right)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ïƒ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\sigma_k</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mtext mathvariant="normal">th</mtext></msup><annotation encoding="application/x-tex">k^{\text{th}}</annotation></semantics></math>
diagonal entry of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Î£</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">\Sigma^{-1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{\sigma^2}</annotation></semantics></math>
is the estimated residual variance.</p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Shrinkage Estimator (Sh):</strong> The Sh estimator is the
most general form in the multiplicative shrinkage family. It applies a
full (non-diagonal) matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msup><mi>ğ‚</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{\mathbf{C}^*}</annotation></semantics></math>
to the OLS estimate and requires solving a <em>Sylvester
equation</em>:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">Sh</mtext></msup><mo>=</mo><mover><msup><mi>ğ‚</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">where </mtext><mspace width="0.333em"></mspace></mrow><mover><msup><mi>ğ‚</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> solves the Sylvester equation:</mtext></mrow><mspace width="0.222em"></mspace><msup><mi>Î£</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mi>ğ‚</mi><mo>+</mo><mi>ğ‚</mi><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo>=</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{\text{Sh}} = \widehat{\mathbf{C}^*} \widehat{\boldsymbol{\beta}}^{\text{OLS}}, \quad \text{where } \widehat{\mathbf{C}^*} \text{ solves the Sylvester equation:} \ \Sigma^{-1} \mathbf{C} + \mathbf{C} \widehat{\boldsymbol{\beta}}^{\text{OLS}} \left(\widehat{\boldsymbol{\beta}}^{\text{OLS}}\right)^T = \widehat{\boldsymbol{\beta}}^{\text{OLS}} \left(\widehat{\boldsymbol{\beta}}^{\text{OLS}}\right)^T.
</annotation></semantics></math></p>
<p>This corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‚</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{D} = \text{diag}\left(\mathbf{C}\right)</annotation></semantics></math>.
Unlike St and DSh, the Sh estimator allows interactions across
coefficients through off-diagonal entries in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msup><mi>ğ‚</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{\mathbf{C}^*}</annotation></semantics></math>,
capturing richer shrinkage structures.</p>
</div>
<div class="section level3">
<h3 id="slab-regression">Slab Regression<a class="anchor" aria-label="anchor" href="#slab-regression"></a>
</h3>
<p>Slab regression introduces a structured quadratic penalty that
shrinks the regression coefficients in specified directions. It is
closely related to the <em>Generalized LASSO</em> estimator introduced
by <a href="https://www.jstor.org/stable/23033600" class="external-link">Tibshirani and Taylor
(2011)</a>, but with key differences. Unlike the Generalized LASSO, slab
regression does not aim for variable selection or sparsity, and it
avoids cross-validation by selecting shrinkage levels through
theoretical MSE criteria. These penalties are based on projection
constraints that can be fixed (e.g., constant direction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ®</mi><mo>=</mo><mn>ğŸ</mn></mrow><annotation encoding="application/x-tex">\mathbf{u} = \mathbf{1}</annotation></semantics></math>)
or structured (e.g., eigenvectors of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>).
This leads to two main estimators.</p>
<ol style="list-style-type: decimal">
<li>
<strong>(Simple) Slab Regression (SR):</strong> The SR estimator
applies a single penalty along a fixed direction vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ®</mi><mo>âˆˆ</mo><msup><mi>â„œ</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{u} \in \Re^{p+1}</annotation></semantics></math>.
A common choice is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ®</mi><mo>=</mo><mn>ğŸ</mn></mrow><annotation encoding="application/x-tex">\mathbf{u} = \mathbf{1}</annotation></semantics></math>.
The estimator is given by:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>S</mi><mi>R</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¼</mi><mo>;</mo><mtext mathvariant="bold">ğ®</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mo>arg</mo><munder><mo>min</mo><mrow><mi>ğ›ƒ</mi><mo>âˆˆ</mo><msup><mi>â„œ</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msubsup><mi>ğ±</mi><mi>i</mi><mi>âŠ¤</mi></msubsup><mi>ğ›ƒ</mi><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo>+</mo><mi>Î¼</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mi>ğ®</mi><mi>âŠ¤</mi></msup><mi>ğ›ƒ</mi><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{SR}\left(\mu;\textbf{u}\right) := \arg\min_{\boldsymbol{\beta}\in\Re^{p+1}} \left( \sum_{i=1}^n \big(y_i - \mathbf{x}_i^\top \boldsymbol{\beta}\big)^2 + \mu \big(\mathbf{u}^\top \boldsymbol{\beta}\big)^2 \right),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu \geq 0</annotation></semantics></math>
is the penalty parameter controls the amount of shrinkage along
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ®</mi><annotation encoding="application/x-tex">\mathbf{u}</annotation></semantics></math>
and has a closed-form, chosen analytically to minimize MSE under the
slab constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mi>âŠ¤</mi></msup><mi>ğ®</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(\boldsymbol{\beta}^\top \mathbf{u})^2</annotation></semantics></math>.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Generalized Slab Regression (GSR):</strong> The GSR
estimator extends SR by allowing shrinkage in multiple directions. These
directions are typically chosen as eigenvectors of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.
The estimator is:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>G</mi><mi>S</mi><mi>R</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mo>arg</mo><munder><mo>min</mo><mrow><mi>ğ›ƒ</mi><mo>âˆˆ</mo><msup><mi>â„œ</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msubsup><mi>ğ±</mi><mi>i</mi><mi>âŠ¤</mi></msubsup><mi>ğ›ƒ</mi><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>l</mi><mo>âˆˆ</mo><mi>â„’</mi></mrow></munder><msub><mi>Î¼</mi><mi>l</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msubsup><mi>ğ®</mi><mi>l</mi><mi>âŠ¤</mi></msubsup><mi>ğ›ƒ</mi><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{GSR}(\boldsymbol{\mu}) := \arg\min_{\boldsymbol{\beta} \in \Re^{p+1}} 
\left(\sum_{i=1}^n \big(y_i - \mathbf{x}_i^\top \boldsymbol{\beta}\big)^2 + \sum_{l \in \mathcal{L}} \mu_l \big(\mathbf{u}_l^\top \boldsymbol{\beta}\big)^2 \right),
</annotation></semantics></math></p>
<p>where each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>l</mi></msub><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_l \geq 0</annotation></semantics></math>
controls the strength of shrinkage along
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ®</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{u}_l</annotation></semantics></math>,
and the set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>â„’</mi><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math>
indexes the selected directions. A special case arises when the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ®</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{u}_l</annotation></semantics></math>
form the standard basis vectors, recovering the classical
<em>Generalized RR</em> of <a href="https://www.jstor.org/stable/1271436" class="external-link">Hoerl and Kennard
(1970)</a>.</p>
</div>
<div class="section level3">
<h3 id="linear-shrinkage">Linear Shrinkage<a class="anchor" aria-label="anchor" href="#linear-shrinkage"></a>
</h3>
<p>The LSh estimator combines the OLS estimator (computed through the
origin) with a target estimator that assumes uncorrelated covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î£</mi><mo accent="true">Ìƒ</mo></mover><mo>=</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widetilde{\Sigma} = \mathrm{diag}(\Sigma)</annotation></semantics></math>).
This target estimator is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msup><mo>=</mo><msup><mover><mi>Î£</mi><mo accent="true">Ìƒ</mo></mover><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><msup><mi>ğ—</mi><mi>T</mi></msup><mi>ğ²</mi></mrow><annotation encoding="application/x-tex">\widehat{\boldsymbol{\beta}}^{ind} = \widetilde{\Sigma}^{-1}\mathbf{X}^T\mathbf{y}</annotation></semantics></math>.
The method assumes that the data are standardized (zero mean and unit
variance) so that the intercept is not needed. The LSh estimator is
defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mover><mrow><mi>ğ›ƒ</mi><mspace width="0.167em"></mspace></mrow><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo>+</mo><mi>Ï</mi><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><msup><mover><mi>Î£</mi><mo accent="true">Ìƒ</mo></mover><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mi>Î£</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mtext mathvariant="bold">ğˆ</mtext><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mover><mrow><mi>ğ›ƒ</mi><mspace width="0.167em"></mspace></mrow><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo>:=</mo><mi>Î£</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mover><mrow><mi>ğ›ƒ</mi><mspace width="0.167em"></mspace></mrow><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{ind}(\rho):=(1-\rho)\widehat{\widehat{\boldsymbol{\beta}\,}}^{OLS}+\rho \widehat{\boldsymbol{\beta}}^{ind}=\left(\rho\widetilde{\Sigma}^{-1}\Sigma + (1-\rho)\textbf{I}_p\right)\widehat{\widehat{\boldsymbol{\beta}\,}}^{OLS}:=\Sigma(\rho)\widehat{\widehat{\boldsymbol{\beta}\,}}^{OLS}, 
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‚</mo></mover><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><annotation encoding="application/x-tex">\widehat{\widehat{\boldsymbol{\beta}}}^{OLS}</annotation></semantics></math>
is the OLS estimator without intercept, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ï</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is the shrinkage intensity chosen to improve stability and reduce
MSE.</p>
</div>
<div class="section level3">
<h3 id="shrinkage-ridge-regression">Shrinkage Ridge Regression<a class="anchor" aria-label="anchor" href="#shrinkage-ridge-regression"></a>
</h3>
<p>The SRR estimator improves upon standard RR by shrinking the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
toward a diagonal matrix with equal entries. Specifically, it shrinks
toward
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><msub><mi>ğˆ</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">v \mathbf{I}_{p+1}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v = \frac{1}{p+1} \mathrm{Tr}(\Sigma)</annotation></semantics></math>
is the average variance across all covariates and the intercept. The SRR
estimator is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>S</mi><mi>R</mi><mi>R</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mi>Î£</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><msup><mtext mathvariant="bold">ğ—</mtext><mi>T</mi></msup><mtext mathvariant="bold">ğ²</mtext><mspace width="1.0em"></mspace><mtext mathvariant="normal">with</mtext><mspace width="1.0em"></mspace><msup><mi>Î£</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Î£</mi><mo>+</mo><mi>Ï</mi><mi>v</mi><msub><mtext mathvariant="bold">ğˆ</mtext><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{\boldsymbol{\beta}}^{SRR}(\rho)=\big(\Sigma^*(\rho)\big)^{-1}\textbf{X}^T\textbf{y} \quad \text{with} \quad \Sigma^*(\rho)=(1-\rho)\Sigma+\rho v \textbf{I}_{p+1}.
</annotation></semantics></math></p>
<p>Unlike the approach in <a href="https://www.sciencedirect.com/science/article/pii/S0047259X03000964" class="external-link">Ledoit
and Wolf (2004)</a>, which minimizes the MSE of the covariance matrix,
SRR chooses the optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Ï</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>
by directly minimizing the MSE of the coefficient estimator. Although
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Ï</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>
does not have a closed form, it can be selected numerically. This
approach is especially useful when the design matrix has a low-rank or
unstable covariance structure, as often encountered in high-dimensional
or collinear settings.</p>
</div>
<div class="section level3">
<h3 id="summary-of-shrinkage-estimators">Summary of Shrinkage Estimators<a class="anchor" aria-label="anchor" href="#summary-of-shrinkage-estimators"></a>
</h3>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Shrinkage Direction</th>
<th>Shrinkage Form</th>
<th>Assumes Standardized Data?</th>
<th>Tuning or Optimizing Required?</th>
<th>Handles Multicollinearity?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>OLS</strong></td>
<td>None</td>
<td>No shrinkage</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>RR</strong></td>
<td>Toward origin</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ—</mi><mi>âŠ¤</mi></msup><mi>ğ—</mi><mo>+</mo><mi>Î»</mi><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><msup><mi>ğ—</mi><mi>âŠ¤</mi></msup><mi>ğ²</mi></mrow><annotation encoding="application/x-tex">\left(\mathbf{X}^\top\mathbf{X} + \lambda I\right)^{-1} \mathbf{X}^\top \mathbf{y}</annotation></semantics></math></td>
<td>No</td>
<td>
<strong>Yes</strong> (cross-validation)</td>
<td><strong>Yes</strong></td>
</tr>
<tr class="odd">
<td><strong>St</strong></td>
<td>Global (scalar)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msup><mi>a</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><mo>â‹…</mo><msup><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup></mrow><annotation encoding="application/x-tex">\widehat{a^*} \cdot \widehat{\beta}^{\text{OLS}}</annotation></semantics></math></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>DSh</strong></td>
<td>Coordinate-wise (diagonal)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><msup><mi>ğ›</mi><mo mathvariant="bold">*</mo></msup><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‹…</mo><msup><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup></mrow><annotation encoding="application/x-tex">\text{diag}\left(\widehat{\mathbf{b^*}}\right) \cdot \widehat{\beta}^{\text{OLS}}</annotation></semantics></math></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td><strong>Sh</strong></td>
<td>Matrix shrinkage (non-diagonal)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msup><mi>ğ‚</mi><mo>*</mo></msup><mo accent="true">Ì‚</mo></mover><mo>â‹…</mo><msup><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">OLS</mtext></msup></mrow><annotation encoding="application/x-tex">\widehat{\mathbf{C}^*} \cdot \widehat{\beta}^{\text{OLS}}</annotation></semantics></math></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>SR</strong></td>
<td>Fixed direction (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{1}</annotation></semantics></math>)</td>
<td>Penalized projection</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td><strong>GSR</strong></td>
<td>Multiple directions (eigenvectors)</td>
<td>Penalized projection</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>LSh</strong></td>
<td>Toward diagonal target</td>
<td>Convex combination</td>
<td><strong>Yes</strong></td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td><strong>SRR</strong></td>
<td>Toward scaled identity</td>
<td>Modified Ridge</td>
<td>No</td>
<td>
<strong>Yes</strong> (numerical minimization)</td>
<td><strong>Yes</strong></td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="simulation-examples">Simulation Examples<a class="anchor" aria-label="anchor" href="#simulation-examples"></a>
</h2>
<p>This section presents a set of simulation studies that demonstrate
the performance of shrinkage estimators implemented in
<code>savvySh</code>. We compare them against OLS using synthetic
datasets. The performance metric is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficients and the true parameter
vector. Lower
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
values indicate better recovery of the true coefficients.</p>
<p>We explore several generative scenarios based on the design matrix
and error distribution. The structure of the design matrix includes
different forms of correlation and dependence. Each simulation is
followed by a table comparing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distances and estimated coefficients.</p>
<p>The following <em>data-generating processes (DGPs)</em> are
considered:</p>
<ul>
<li><p><a href="#multivariate-gaussian-distribution">Multivariate
Gaussian distributed covariates with Toeplitz covariance matrix</a> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>,</mo><mi>ğš¿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(\pmb{\mu}, \pmb{\Psi}(\rho))</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğš¿</mi><mrow><mi>s</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>Ï</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mo>âˆ’</mo><mi>t</mi><mo stretchy="true" form="postfix">|</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\pmb{\Psi}_{st}(\rho) = \rho^{|s-t|}</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>â‰¤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leq s, t \leq p</annotation></semantics></math>,
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¼</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Î¼</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î¼</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\pmb{\mu} = (\mu_1, \mu_2, \ldots, \mu_p)^T</annotation></semantics></math>
is the mean vector,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš¿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pmb{\Psi}(\rho)</annotation></semantics></math>
is the covariance matrix, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ï</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
represents the correlation coefficient that controls the dependence
between covariates. The response is generated using normal
noise.</p></li>
<li><p><a href="#students-t-distribution">Studentâ€™s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distributed Multivariate Gaussian distributed covariates with Toeplitz
covariance matrix</a> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>,</mo><mi>ğš¿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(\pmb{\mu}, \pmb{\Psi}(\rho))</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğš¿</mi><mrow><mi>s</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>Ï</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mo>âˆ’</mo><mi>t</mi><mo stretchy="true" form="postfix">|</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\pmb{\Psi}_{st}(\rho) = \rho^{|s-t|}</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>â‰¤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leq s, t \leq p</annotation></semantics></math>.
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¼</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Î¼</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î¼</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\pmb{\mu} = (\mu_1, \mu_2, \ldots, \mu_p)^T</annotation></semantics></math>
is the mean vector,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš¿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pmb{\Psi}(\rho)</annotation></semantics></math>
is the covariance matrix, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ï</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
represents the correlation coefficient that controls the dependence
between covariates. The response includes heavier-tailed
variation.</p></li>
<li><p><a href="#gaussian-copula-with-binomial-margins">Multivariate
Gaussian Copula with Binomial marginal distributed covariates and
Toeplitz covariance matrix</a> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="bold">ğ™</mtext><mi>i</mi></msub><mo>âˆ¼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="bold">ğŸ</mtext><mo>,</mo><mi>Î¨</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textbf{Z}_i\sim N(\textbf{0}, \Psi(\rho))</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><msup><mi>F</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¦</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{ik} = F^{-1}(\Phi(Z_{ik}))</annotation></semantics></math>,
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leq k \leq p</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¦</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
is the <em>cumulative distribution function (CDF)</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>F</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">F^{-1}</annotation></semantics></math>
is the inverse CDF of the binomial distribution.</p></li>
<li><p><a href="#latent-space-features">Latent Space Features</a> -
Covariates are generated by combining a low-rank structure with random
variations, Specifically, we simulate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ—</mi><mo>=</mo><mi>ğ€</mi><mi>ğ™</mi><mo>+</mo><mi>ğ„</mi></mrow><annotation encoding="application/x-tex">\mathbf{X} = \mathbf{A} \mathbf{Z} + \mathbf{E}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ€</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">n \times f</annotation></semantics></math>
matrix of factor loadings with entries drawn independently from a
standard normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ™</mi><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">f \times p</annotation></semantics></math>
matrix of latent factors, also with entries drawn independently from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math>.
The term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
matrix of independent Gaussian noise with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mi>âˆ’</mi><mn>6</mn></mrow></msup><annotation encoding="application/x-tex">10^{-6}</annotation></semantics></math>,
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mn>10</mn><mrow><mi>âˆ’</mi><mn>6</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0,10^{-6})</annotation></semantics></math>.</p></li>
</ul>
<p>In all four settings, the true regression coefficient vector
alternates in sign with increasing magnitude, making it possible to
assess the shrinkage effect across varying coefficient scales.</p>
<p><strong>Note:</strong> Due to differences in underlying libraries and
random number generation implementations (e.g., BLAS/LAPACK and RNG
behavior), the data generated by functions like <code>mvrnorm</code> may
differ slightly between Windows and macOS/Linux, even with the same
seed.</p>
<div class="section level3">
<h3 id="multiplicative-shrinkage-and-slab-regression">Multiplicative Shrinkage and Slab Regression<a class="anchor" aria-label="anchor" href="#multiplicative-shrinkage-and-slab-regression"></a>
</h3>
<p>This section shows how <code>savvySh</code> implements multiplicative
shrinkage including St, DSh, and Sh; Slab Shrinkage including SR and
GSR. Each method is compared to OLS.</p>
<div class="section level4">
<h4 id="multivariate-gaussian-distribution">Multivariate Gaussian Distribution<a class="anchor" aria-label="anchor" href="#multivariate-gaussian-distribution"></a>
</h4>
<p>This example corresponds to the <a href="#multivariate-gaussian-distribution">Multivariate Gaussian
distributed covariates with Toeplitz covariance matrix</a> setup
described above. We simulate a design matrix from a multivariate normal
distribution with a Toeplitz covariance matrix. The response is
generated with Gaussian noise with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">\sigma^2 = 25</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">rho_val</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">sigma_val</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">mu_val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">sigma.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rho_val</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># True beta</span></span>
<span><span class="va">theta_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></span>
<span>  <span class="va">mag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">sgn</span> <span class="op">*</span> <span class="va">mag</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu">sigma.rho</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu_val</span>, <span class="va">p_val</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">X_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu">theta_func</span><span class="op">(</span><span class="va">p_val</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mean <span class="op">=</span> <span class="va">X_intercept</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_true</span>, sd <span class="op">=</span> <span class="va">sigma_val</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multi_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Multiplicative"</span>, include_Sh <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">beta_St</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"St"</span><span class="op">)</span></span>
<span><span class="va">beta_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"DSh"</span><span class="op">)</span></span>
<span><span class="va">beta_Sh</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"Sh"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slab_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Slab"</span><span class="op">)</span></span>
<span><span class="va">beta_SR</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"SR"</span><span class="op">)</span></span>
<span><span class="va">beta_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"GSR"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"St"</span>, <span class="st">"DSh"</span>, <span class="st">"Sh"</span>, <span class="st">"SR"</span>, <span class="st">"GSR"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_ols</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_St</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_DSh</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_Sh</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_SR</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_GSR</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">0.9791</td>
</tr>
<tr class="even">
<td align="left">St</td>
<td align="right">0.9292</td>
</tr>
<tr class="odd">
<td align="left">DSh</td>
<td align="right">0.9261</td>
</tr>
<tr class="even">
<td align="left">Sh</td>
<td align="right">0.9787</td>
</tr>
<tr class="odd">
<td align="left">SR</td>
<td align="right">1.0092</td>
</tr>
<tr class="even">
<td align="left">GSR</td>
<td align="right">0.9491</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_ols</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  St <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_St</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  DSh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_DSh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Sh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_Sh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  SR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_SR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  GSR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_GSR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">St</th>
<th align="right">DSh</th>
<th align="right">Sh</th>
<th align="right">SR</th>
<th align="right">GSR</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.135</td>
<td align="right">1.129</td>
<td align="right">1.113</td>
<td align="right">1.135</td>
<td align="right">0.751</td>
<td align="right">1.150</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">-1.148</td>
<td align="right">-1.142</td>
<td align="right">-1.103</td>
<td align="right">-1.148</td>
<td align="right">-1.382</td>
<td align="right">-1.135</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">2.348</td>
<td align="right">2.336</td>
<td align="right">2.311</td>
<td align="right">2.348</td>
<td align="right">2.262</td>
<td align="right">2.310</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">X3</td>
<td align="right">-2.079</td>
<td align="right">-2.068</td>
<td align="right">-2.035</td>
<td align="right">-2.079</td>
<td align="right">-2.053</td>
<td align="right">-2.061</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="left">X4</td>
<td align="right">3.120</td>
<td align="right">3.103</td>
<td align="right">3.090</td>
<td align="right">3.120</td>
<td align="right">3.014</td>
<td align="right">3.144</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">X5</td>
<td align="right">-2.923</td>
<td align="right">-2.908</td>
<td align="right">-2.890</td>
<td align="right">-2.923</td>
<td align="right">-2.958</td>
<td align="right">-2.919</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="left">X6</td>
<td align="right">4.286</td>
<td align="right">4.263</td>
<td align="right">4.264</td>
<td align="right">4.285</td>
<td align="right">4.195</td>
<td align="right">4.288</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">X7</td>
<td align="right">-4.759</td>
<td align="right">-4.734</td>
<td align="right">-4.741</td>
<td align="right">-4.759</td>
<td align="right">-4.791</td>
<td align="right">-4.763</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="left">X8</td>
<td align="right">5.196</td>
<td align="right">5.168</td>
<td align="right">5.178</td>
<td align="right">5.195</td>
<td align="right">5.171</td>
<td align="right">5.201</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">X9</td>
<td align="right">-5.120</td>
<td align="right">-5.093</td>
<td align="right">-5.103</td>
<td align="right">-5.120</td>
<td align="right">-5.204</td>
<td align="right">-5.074</td>
<td align="right">-5</td>
</tr>
<tr class="odd">
<td align="left">X10</td>
<td align="right">6.245</td>
<td align="right">6.212</td>
<td align="right">6.235</td>
<td align="right">6.245</td>
<td align="right">6.045</td>
<td align="right">6.146</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="students-t-distribution">Studentâ€™s t Distribution<a class="anchor" aria-label="anchor" href="#students-t-distribution"></a>
</h4>
<p>This example corresponds to the <a href="#students-t-distribution">Studentâ€™s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distributed Multivariate Gaussian distributed covariates with Toeplitz
covariance matrix</a> setup. We repeat the same design as above, but
instead of Gaussian noise, we add a scaled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distributed
noise with degrees of freedom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î½</mi><mo>=</mo><mfrac><mn>50</mn><mn>24</mn></mfrac></mrow><annotation encoding="application/x-tex">\nu = \frac{50}{24}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">rho_val</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">df_val</span> <span class="op">=</span> <span class="fl">50</span><span class="op">/</span><span class="fl">24</span> </span>
<span><span class="va">mu_val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">sigma.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rho_val</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># True beta</span></span>
<span><span class="va">theta_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></span>
<span>  <span class="va">mag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">sgn</span> <span class="op">*</span> <span class="va">mag</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu">sigma.rho</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu_val</span>, <span class="va">p_val</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">X_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu">theta_func</span><span class="op">(</span><span class="va">p_val</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X_intercept</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_true</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_val</span>, df <span class="op">=</span> <span class="va">df_val</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multi_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Multiplicative"</span>, include_Sh <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">beta_St</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"St"</span><span class="op">)</span></span>
<span><span class="va">beta_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"DSh"</span><span class="op">)</span></span>
<span><span class="va">beta_Sh</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"Sh"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slab_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Slab"</span><span class="op">)</span></span>
<span><span class="va">beta_SR</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"SR"</span><span class="op">)</span></span>
<span><span class="va">beta_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"GSR"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"St"</span>, <span class="st">"DSh"</span>, <span class="st">"Sh"</span>, <span class="st">"SR"</span>, <span class="st">"GSR"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_ols</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_St</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_DSh</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_Sh</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_SR</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_GSR</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">5.8495</td>
</tr>
<tr class="even">
<td align="left">St</td>
<td align="right">5.8271</td>
</tr>
<tr class="odd">
<td align="left">DSh</td>
<td align="right">5.2781</td>
</tr>
<tr class="even">
<td align="left">Sh</td>
<td align="right">5.8494</td>
</tr>
<tr class="odd">
<td align="left">SR</td>
<td align="right">5.9631</td>
</tr>
<tr class="even">
<td align="left">GSR</td>
<td align="right">5.1581</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_ols</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  St <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_St</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  DSh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_DSh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Sh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_Sh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  SR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_SR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  GSR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_GSR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">St</th>
<th align="right">DSh</th>
<th align="right">Sh</th>
<th align="right">SR</th>
<th align="right">GSR</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.345</td>
<td align="right">-0.252</td>
<td align="right">-0.023</td>
<td align="right">-0.345</td>
<td align="right">-0.623</td>
<td align="right">-0.368</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">-0.115</td>
<td align="right">-0.084</td>
<td align="right">0.000</td>
<td align="right">-0.115</td>
<td align="right">-0.285</td>
<td align="right">0.488</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">-0.811</td>
<td align="right">-0.592</td>
<td align="right">-0.082</td>
<td align="right">-0.811</td>
<td align="right">-0.873</td>
<td align="right">-0.426</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">X3</td>
<td align="right">1.835</td>
<td align="right">1.339</td>
<td align="right">0.653</td>
<td align="right">1.835</td>
<td align="right">1.853</td>
<td align="right">0.068</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="left">X4</td>
<td align="right">3.308</td>
<td align="right">2.413</td>
<td align="right">2.118</td>
<td align="right">3.308</td>
<td align="right">3.232</td>
<td align="right">3.587</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">X5</td>
<td align="right">-5.577</td>
<td align="right">-4.069</td>
<td align="right">-4.621</td>
<td align="right">-5.577</td>
<td align="right">-5.602</td>
<td align="right">-4.396</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="left">X6</td>
<td align="right">3.148</td>
<td align="right">2.297</td>
<td align="right">1.955</td>
<td align="right">3.148</td>
<td align="right">3.082</td>
<td align="right">2.635</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">X7</td>
<td align="right">-2.880</td>
<td align="right">-2.101</td>
<td align="right">-1.677</td>
<td align="right">-2.879</td>
<td align="right">-2.903</td>
<td align="right">-1.918</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="left">X8</td>
<td align="right">5.121</td>
<td align="right">3.736</td>
<td align="right">4.178</td>
<td align="right">5.121</td>
<td align="right">5.103</td>
<td align="right">3.825</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">X9</td>
<td align="right">-5.497</td>
<td align="right">-4.011</td>
<td align="right">-4.614</td>
<td align="right">-5.497</td>
<td align="right">-5.558</td>
<td align="right">-4.731</td>
<td align="right">-5</td>
</tr>
<tr class="odd">
<td align="left">X10</td>
<td align="right">5.805</td>
<td align="right">4.235</td>
<td align="right">5.207</td>
<td align="right">5.805</td>
<td align="right">5.660</td>
<td align="right">4.447</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="gaussian-copula-with-binomial-margins">Gaussian Copula with Binomial Margins<a class="anchor" aria-label="anchor" href="#gaussian-copula-with-binomial-margins"></a>
</h4>
<p>This example corresponds to the <a href="#gaussian-copula-with-binomial-margins">Multivariate Gaussian
Copula with Binomial marginal distributed covariates and Toeplitz
covariance matrix</a> setup. The covariates are transformed from a
Gaussian copula to Binomial marginals using the inverse CDF transform.
This simulates discrete predictor variables.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">rho_val</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">q_0</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">sigma.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rho_val</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sigma.temp</span> <span class="op">&lt;-</span> <span class="fu">sigma.rho</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> </span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p_val</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">sigma.temp</span><span class="op">)</span> </span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z_col</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">qbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z_col</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, prob <span class="op">=</span> <span class="va">q_0</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">X_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_val</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X_intercept</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_true</span><span class="op">)</span>, sd <span class="op">=</span> <span class="va">sigma_val</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">beta_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multi_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Multiplicative"</span>, include_Sh <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">beta_St</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"St"</span><span class="op">)</span></span>
<span><span class="va">beta_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"DSh"</span><span class="op">)</span></span>
<span><span class="va">beta_Sh</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">multi_results</span>, <span class="st">"Sh"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slab_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Slab"</span><span class="op">)</span></span>
<span><span class="va">beta_SR</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"SR"</span><span class="op">)</span></span>
<span><span class="va">beta_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">slab_results</span>, <span class="st">"GSR"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"St"</span>, <span class="st">"DSh"</span>, <span class="st">"Sh"</span>, <span class="st">"SR"</span>, <span class="st">"GSR"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_ols</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_St</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_DSh</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_Sh</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_SR</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_GSR</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">3.0967</td>
</tr>
<tr class="even">
<td align="left">St</td>
<td align="right">1.0756</td>
</tr>
<tr class="odd">
<td align="left">DSh</td>
<td align="right">1.8059</td>
</tr>
<tr class="even">
<td align="left">Sh</td>
<td align="right">3.0724</td>
</tr>
<tr class="odd">
<td align="left">SR</td>
<td align="right">3.1182</td>
</tr>
<tr class="even">
<td align="left">GSR</td>
<td align="right">1.6176</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_ols</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  St <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_St</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  DSh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_DSh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Sh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_Sh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  SR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_SR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  GSR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_GSR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">St</th>
<th align="right">DSh</th>
<th align="right">Sh</th>
<th align="right">SR</th>
<th align="right">GSR</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.122</td>
<td align="right">0.042</td>
<td align="right">0.043</td>
<td align="right">0.123</td>
<td align="right">0.133</td>
<td align="right">0.048</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">0.442</td>
<td align="right">0.153</td>
<td align="right">0.045</td>
<td align="right">0.439</td>
<td align="right">0.420</td>
<td align="right">0.060</td>
<td align="right">0.297</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">-0.681</td>
<td align="right">-0.235</td>
<td align="right">-0.112</td>
<td align="right">-0.674</td>
<td align="right">-0.842</td>
<td align="right">-0.352</td>
<td align="right">0.098</td>
</tr>
<tr class="even">
<td align="left">X3</td>
<td align="right">0.549</td>
<td align="right">0.190</td>
<td align="right">0.070</td>
<td align="right">0.545</td>
<td align="right">0.459</td>
<td align="right">0.081</td>
<td align="right">0.136</td>
</tr>
<tr class="odd">
<td align="left">X4</td>
<td align="right">0.302</td>
<td align="right">0.104</td>
<td align="right">0.010</td>
<td align="right">0.307</td>
<td align="right">0.225</td>
<td align="right">0.462</td>
<td align="right">0.057</td>
</tr>
<tr class="even">
<td align="left">X5</td>
<td align="right">1.634</td>
<td align="right">0.564</td>
<td align="right">0.979</td>
<td align="right">1.622</td>
<td align="right">1.542</td>
<td align="right">1.167</td>
<td align="right">0.249</td>
</tr>
<tr class="odd">
<td align="left">X6</td>
<td align="right">-0.049</td>
<td align="right">-0.017</td>
<td align="right">0.000</td>
<td align="right">-0.048</td>
<td align="right">-0.153</td>
<td align="right">0.030</td>
<td align="right">0.070</td>
</tr>
<tr class="even">
<td align="left">X7</td>
<td align="right">-0.278</td>
<td align="right">-0.096</td>
<td align="right">-0.014</td>
<td align="right">-0.277</td>
<td align="right">-0.308</td>
<td align="right">-0.194</td>
<td align="right">0.093</td>
</tr>
<tr class="odd">
<td align="left">X8</td>
<td align="right">-1.633</td>
<td align="right">-0.564</td>
<td align="right">-1.036</td>
<td align="right">-1.623</td>
<td align="right">-1.668</td>
<td align="right">-0.784</td>
<td align="right">0.168</td>
</tr>
<tr class="even">
<td align="left">X9</td>
<td align="right">1.858</td>
<td align="right">0.642</td>
<td align="right">1.223</td>
<td align="right">1.841</td>
<td align="right">1.797</td>
<td align="right">0.759</td>
<td align="right">0.181</td>
</tr>
<tr class="odd">
<td align="left">X10</td>
<td align="right">-0.628</td>
<td align="right">-0.217</td>
<td align="right">-0.105</td>
<td align="right">-0.620</td>
<td align="right">-0.761</td>
<td align="right">-0.007</td>
<td align="right">0.138</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="linear-shrinkage-1">Linear Shrinkage<a class="anchor" aria-label="anchor" href="#linear-shrinkage-1"></a>
</h3>
<p>This section describes the LSh estimator, which shrinks the OLS
coefficients (through the origin) toward a target based on the diagonal
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.
The method assumes standardized data.</p>
<div class="section level4">
<h4 id="multivariate-gaussian-distribution-1">Multivariate Gaussian Distribution<a class="anchor" aria-label="anchor" href="#multivariate-gaussian-distribution-1"></a>
</h4>
<p>This example corresponds to the <a href="#multivariate-gaussian-distribution">Multivariate Gaussian
distributed covariates with Toeplitz covariance matrix</a> setup. We
simulate from a Gaussian design with Toeplitz correlation, using
additive Gaussian noise with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">\sigma^2 = 25</annotation></semantics></math>.
<strong>Centering is applied before estimation</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">rho_val</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">sigma_val</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">mu_val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">sigma.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rho_val</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># True beta</span></span>
<span><span class="va">theta_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></span>
<span>  <span class="va">mag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">sgn</span> <span class="op">*</span> <span class="va">mag</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu">sigma.rho</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu_val</span>, <span class="va">p_val</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">X_centred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu">theta_func</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mean <span class="op">=</span> <span class="va">X_centred</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_true</span>, sd <span class="op">=</span> <span class="va">sigma_val</span><span class="op">)</span></span>
<span><span class="va">y_centred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">y</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y_centred</span> <span class="op">~</span> <span class="va">X_centred</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">beta_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X_centred</span>, <span class="va">y_centred</span>, model_class <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span></span>
<span><span class="va">beta_LSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">linear_results</span>, <span class="st">"LSh"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"LSh"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_ols</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_LSh</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">0.9697</td>
</tr>
<tr class="even">
<td align="left">LSh</td>
<td align="right">1.0187</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_ols</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  LSh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_LSh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">LSh</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">X_centred1</td>
<td align="right">0.852</td>
<td align="right">0.854</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">X_centred2</td>
<td align="right">-0.652</td>
<td align="right">-0.638</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">X_centred3</td>
<td align="right">1.921</td>
<td align="right">1.915</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">X_centred4</td>
<td align="right">-1.880</td>
<td align="right">-1.859</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="left">X_centred5</td>
<td align="right">3.077</td>
<td align="right">3.062</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">X_centred6</td>
<td align="right">-2.714</td>
<td align="right">-2.690</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="left">X_centred7</td>
<td align="right">3.241</td>
<td align="right">3.218</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">X_centred8</td>
<td align="right">-3.804</td>
<td align="right">-3.779</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="left">X_centred9</td>
<td align="right">4.880</td>
<td align="right">4.838</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">X_centred10</td>
<td align="right">-4.755</td>
<td align="right">-4.732</td>
<td align="right">-5</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="students-t-distribution-1">Studentâ€™s t Distribution<a class="anchor" aria-label="anchor" href="#students-t-distribution-1"></a>
</h4>
<p>This example corresponds to the <a href="#students-t-distribution">Studentâ€™s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distributed Multivariate Gaussian distributed covariates with Toeplitz
covariance matrix</a> setup. We repeat the setup from above but replace
Gaussian noise with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distributed
noise with degrees of freedom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î½</mi><mo>=</mo><mfrac><mn>50</mn><mn>24</mn></mfrac></mrow><annotation encoding="application/x-tex">\nu = \frac{50}{24}</annotation></semantics></math>.
<strong>Centering is applied before estimation</strong>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">df_val</span> <span class="op">=</span> <span class="fl">50</span><span class="op">/</span><span class="fl">24</span> </span>
<span><span class="va">sigma_val</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">mu_val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">sigma.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rho_val</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p_val</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># True beta</span></span>
<span><span class="va">theta_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></span>
<span>  <span class="va">mag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">sgn</span> <span class="op">*</span> <span class="va">mag</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu">sigma.rho</span><span class="op">(</span><span class="va">rho_val</span>, <span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_val</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu_val</span>, <span class="va">p_val</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">X_centred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu">theta_func</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X_centred</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_true</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_val</span>, df <span class="op">=</span> <span class="va">df_val</span><span class="op">)</span></span>
<span><span class="va">y_centred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">y</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y_centred</span> <span class="op">~</span> <span class="va">X_centred</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">beta_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X_centred</span>, <span class="va">y_centred</span>, model_class <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span></span>
<span><span class="va">beta_LSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">linear_results</span>, <span class="st">"LSh"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"LSh"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_ols</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_LSh</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">5.6927</td>
</tr>
<tr class="even">
<td align="left">LSh</td>
<td align="right">4.8586</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_ols</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  LSh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_LSh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">LSh</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">X_centred1</td>
<td align="right">1.885</td>
<td align="right">1.698</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">X_centred2</td>
<td align="right">-3.811</td>
<td align="right">-2.715</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">X_centred3</td>
<td align="right">5.835</td>
<td align="right">4.813</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">X_centred4</td>
<td align="right">-1.692</td>
<td align="right">-1.179</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="left">X_centred5</td>
<td align="right">0.423</td>
<td align="right">0.297</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">X_centred6</td>
<td align="right">-3.852</td>
<td align="right">-3.078</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="left">X_centred7</td>
<td align="right">5.120</td>
<td align="right">3.907</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">X_centred8</td>
<td align="right">-3.879</td>
<td align="right">-3.122</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="left">X_centred9</td>
<td align="right">4.503</td>
<td align="right">3.199</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">X_centred10</td>
<td align="right">-5.195</td>
<td align="right">-4.492</td>
<td align="right">-5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="shrinkage-ridge-regression-1">Shrinkage Ridge Regression<a class="anchor" aria-label="anchor" href="#shrinkage-ridge-regression-1"></a>
</h3>
<p>The SRR estimator improves upon RR by replacing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
with a convex combination of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
and a scaled identity matrix, chosen to minimize the MSE of the
coefficients.</p>
<div class="section level4">
<h4 id="latent-space-features">Latent Space Features<a class="anchor" aria-label="anchor" href="#latent-space-features"></a>
</h4>
<p>This example corresponds to the <a href="#latent-space-features">Latent Space Features</a> setup. Here,
covariates are generated using a latent factor model with a small amount
of additive Gaussian noise. This simulates a low-rank structure in the
design matrix. We compare ridge regression estimates using
<code>glmnet</code> against the SRR from <code>savvySh</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_val</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">f_val</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">sigma_val</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># True beta</span></span>
<span><span class="va">theta_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></span>
<span>  <span class="va">mag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_val</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">sgn</span> <span class="op">*</span> <span class="va">mag</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span> <span class="op">*</span> <span class="va">f_val</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_val</span><span class="op">)</span>  </span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">f_val</span> <span class="op">*</span> <span class="va">p_val</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">f_val</span><span class="op">)</span> </span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span>  <span class="co"># n x p matrix</span></span>
<span><span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span> <span class="op">*</span> <span class="va">p_val</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_val</span><span class="op">)</span></span>
<span><span class="va">X_noisy</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">+</span> <span class="va">noise</span></span>
<span><span class="va">X_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_val</span><span class="op">)</span>, <span class="va">X_noisy</span><span class="op">)</span></span>
<span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu">theta_func</span><span class="op">(</span><span class="va">p_val</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_val</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X_intercept</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta_true</span><span class="op">)</span>,sd<span class="op">=</span><span class="va">sigma_val</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">OLS_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">X_noisy</span><span class="op">)</span></span>
<span><span class="va">beta_OLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">OLS_results</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glmnet_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="va">X_noisy</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">lambda_min_RR_glmnet</span> <span class="op">&lt;-</span> <span class="va">glmnet_fit</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">beta_RR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">glmnet_fit</span>, s <span class="op">=</span> <span class="st">"lambda.min"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SRR_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/savvySh.html">savvySh</a></span><span class="op">(</span><span class="va">X_noisy</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"ShrinkageRR"</span><span class="op">)</span></span>
<span><span class="va">beta_SRR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">SRR_results</span>, <span class="st">"SRR"</span><span class="op">)</span></span></code></pre></div>
<p>The tables below report the results of each estimator: the first
table shows the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
distance between the estimated coefficient vector and the ground truth,
while the second table displays the actual estimated coefficients
(rounded) for each method alongside the true values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># L2 comparison</span></span>
<span><span class="va">l2_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="st">"RR"</span>, <span class="st">"SRR"</span><span class="op">)</span>,</span>
<span>  L2_Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_OLS</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_RR</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_SRR</span>  <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">l2_table</span>, digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"L2 Distance Between Estimated and True Coefficients"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>L2 Distance Between Estimated and True Coefficients</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">L2_Distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">OLS</td>
<td align="right">313.7002</td>
</tr>
<tr class="even">
<td align="left">RR</td>
<td align="right">13.8878</td>
</tr>
<tr class="odd">
<td align="left">SRR</td>
<td align="right">9.0543</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Coefficient comparison table</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OLS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_OLS</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  RR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_RR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  SRR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_SRR</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_true</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef_table</span>, caption <span class="op">=</span> <span class="st">"Estimated Coefficients by Method (rounded)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated Coefficients by Method (rounded)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">OLS</th>
<th align="right">RR</th>
<th align="right">SRR</th>
<th align="right">True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.010</td>
<td align="right">1.011</td>
<td align="right">1.007</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">X_noisy1</td>
<td align="right">45.350</td>
<td align="right">3.057</td>
<td align="right">2.838</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">X_noisy2</td>
<td align="right">-4.960</td>
<td align="right">-8.059</td>
<td align="right">-2.278</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">X_noisy3</td>
<td align="right">147.454</td>
<td align="right">-0.907</td>
<td align="right">-0.780</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="left">X_noisy4</td>
<td align="right">42.069</td>
<td align="right">2.850</td>
<td align="right">4.477</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">X_noisy5</td>
<td align="right">-63.730</td>
<td align="right">0.541</td>
<td align="right">0.154</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="left">X_noisy6</td>
<td align="right">-186.510</td>
<td align="right">1.760</td>
<td align="right">1.627</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">X_noisy7</td>
<td align="right">118.817</td>
<td align="right">0.063</td>
<td align="right">-0.727</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="left">X_noisy8</td>
<td align="right">-17.079</td>
<td align="right">2.482</td>
<td align="right">3.598</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">X_noisy9</td>
<td align="right">-132.102</td>
<td align="right">-0.035</td>
<td align="right">-2.048</td>
<td align="right">-5</td>
</tr>
<tr class="odd">
<td align="left">X_noisy10</td>
<td align="right">31.292</td>
<td align="right">3.009</td>
<td align="right">3.117</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="real-data-analysis">Real Data Analysis<a class="anchor" aria-label="anchor" href="#real-data-analysis"></a>
</h2>
<p>This section provides example code and references for applying the
shrinkage estimators implemented in <code>savvySh</code> to real-world
datasets. These applications demonstrate how shrinkage methods can be
used in areas such as generalized linear models, portfolio investment,
and fine-mapping in genetics. We do not run the code or present specific
results here; instead, we offer clean, reproducible examples that users
can adapt. Full details and preprocessing steps can be found in the
relevant repositories or the <a href="https://openaccess.city.ac.uk/id/eprint/35005/" class="external-link">main
paper</a>.</p>
<ul>
<li><p>The <strong>cybersickness dataset</strong> is used for
illustrating shrinkage GLMs using a Poisson model. The main Shrinkage
GLMs function is part of the related package <code>savvyGLM</code>, you
can find <a href="https://github.com/Ziwei-ChenChen/savvyGLM" class="external-link">here</a>.</p></li>
<li><p>The <strong>returns_441 dataset</strong> contains portfolio
returns and is used for demonstrating shrinkage estimation in financial
asset allocation.</p></li>
<li><p>The <strong>Statistical Fine-Mapping Application</strong>
demonstrates the use of shrinkage-based estimators in a genetic context.
We do not provide detailed descriptions here, as the full R code and
analysisâ€”including data preparation and model fittingâ€”are available
at:<a href="https://github.com/jennasimit/flashfm-savvySh" class="external-link"><code>flashfm-savvySh</code></a>.</p></li>
</ul>
<div class="section level3">
<h3 id="cybersickness-data">Cybersickness data<a class="anchor" aria-label="anchor" href="#cybersickness-data"></a>
</h3>
<p>This example demonstrates how to apply Poisson GLMs and various
shrinkage estimators to a dataset related to cybersickness severity
scores. We use the <code>cybersickness_10lags</code> dataset, included
in the package under <code>data/cybersickness_10lags.rda</code>. The
response variable is ordinal and grouped into four categories. The goal
is to predict this ordinal outcome using lagged predictors. Here we show
how to preprocess, fit models, and evaluate prediction performance using
metrics such as MSE, RMSE, and MAE.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Ziwei-ChenChen/savvyGLM"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvyGLM" class="external-link">savvyGLM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvyGLM" class="external-link">savvyGLM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">standardize_features</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="va">dataset</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">set_classes</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span> </span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2.5</span>,<span class="fl">3</span>,<span class="fl">3.5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> </span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> </span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">&gt;=</span><span class="fl">7</span>, <span class="fl">3</span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_and_return_coefficients</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">control_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">200</span>, epsilon <span class="op">=</span> <span class="fl">1e-6</span>, trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">family_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Fitting models</span></span>
<span>  <span class="va">opt_glm2_OLS</span> <span class="op">&lt;-</span> <span class="fu">glm.fit2</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  <span class="va">opt_glm2_SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Ziwei-ChenChen.github.io/savvyGLM/reference/savvy_glm.fit2.html" class="external-link">savvy_glm.fit2</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"SR"</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  <span class="va">opt_glm2_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Ziwei-ChenChen.github.io/savvyGLM/reference/savvy_glm.fit2.html" class="external-link">savvy_glm.fit2</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"GSR"</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  <span class="va">opt_glm2_St</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Ziwei-ChenChen.github.io/savvyGLM/reference/savvy_glm.fit2.html" class="external-link">savvy_glm.fit2</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"St"</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  <span class="va">opt_glm2_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Ziwei-ChenChen.github.io/savvyGLM/reference/savvy_glm.fit2.html" class="external-link">savvy_glm.fit2</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"DSh"</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  <span class="va">opt_glm2_Sh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Ziwei-ChenChen.github.io/savvyGLM/reference/savvy_glm.fit2.html" class="external-link">savvy_glm.fit2</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, model_class <span class="op">=</span> <span class="st">"Sh"</span>, family <span class="op">=</span> <span class="va">family_type</span>, control <span class="op">=</span> <span class="va">control_list</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    glm2_OLS_result <span class="op">=</span> <span class="va">opt_glm2_OLS</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    glm2_SR_result <span class="op">=</span> <span class="va">opt_glm2_SR</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    glm2_GSR_result <span class="op">=</span> <span class="va">opt_glm2_GSR</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    glm2_St_result <span class="op">=</span> <span class="va">opt_glm2_St</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    glm2_DSh_result <span class="op">=</span> <span class="va">opt_glm2_DSh</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    glm2_Sh_result <span class="op">=</span> <span class="va">opt_glm2_Sh</span><span class="op">$</span><span class="va">coefficients</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">test_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">glm_coefficients</span>, <span class="va">data_X</span>, <span class="va">data_Y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">upper_limit</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># =3 for 4 classes; =9 for 10 classes</span></span>
<span>  </span>
<span>  <span class="co">### Model 1 ---&gt; OLS ###</span></span>
<span>  <span class="va">predicted_glm2_OLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_OLS_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_OLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_OLS</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_OLS</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">### Model 2 ---&gt; SR ###</span></span>
<span>  <span class="va">predicted_glm2_SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_SR_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_SR</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_SR</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">### Model 3 ---&gt; GSR ###</span></span>
<span>  <span class="va">predicted_glm2_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_GSR_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_GSR</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_GSR</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">### Model 4 ---&gt; Stein ###</span></span>
<span>  <span class="va">predicted_glm2_St</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_St_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_St</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_St</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_St</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">### Model 5 ---&gt; Diagonal Shrinkage ###</span></span>
<span>  <span class="va">predicted_glm2_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_DSh_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_DSh</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_DSh</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">### Model 6 ---&gt; Sh ###</span></span>
<span>  <span class="va">predicted_glm2_Sh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">data_X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glm_coefficients</span><span class="op">$</span><span class="va">glm2_Sh_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_glm2_Sh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_glm2_Sh</span> <span class="op">&lt;=</span> <span class="va">upper_limit</span>, <span class="va">predicted_glm2_Sh</span>, <span class="va">upper_limit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">predicted_glm2_OLS</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">predicted_glm2_SR</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">r_OLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_OLS</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_OLS</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_OLS</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r_SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_SR</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_SR</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_SR</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r_GSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_GSR</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_GSR</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_GSR</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r_St</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_St</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_St</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_St</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r_DSh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_DSh</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_DSh</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_DSh</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r_Sh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_Sh</span><span class="op">)</span>, <span class="fu">rmse</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_Sh</span><span class="op">)</span>, <span class="fu">mae</span><span class="op">(</span><span class="va">data_Y</span>, <span class="va">predicted_glm2_Sh</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    results_OLS <span class="op">=</span> <span class="va">r_OLS</span>,</span>
<span>    results_SR <span class="op">=</span> <span class="va">r_SR</span>,</span>
<span>    results_GSR <span class="op">=</span> <span class="va">r_GSR</span>,</span>
<span>    results_St <span class="op">=</span> <span class="va">r_St</span>,</span>
<span>    results_DSh <span class="op">=</span> <span class="va">r_DSh</span>,</span>
<span>    results_Sh <span class="op">=</span> <span class="va">r_Sh</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_of_sample_performance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">percentage</span> <span class="op">=</span> <span class="fl">0.3</span>, <span class="va">no_trials</span> <span class="op">=</span> <span class="fl">50</span>, <span class="va">filein</span> <span class="op">=</span> <span class="st">"data_for_regression10.csv"</span>, <span class="va">fileout</span> <span class="op">=</span> <span class="st">"results10.csv"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">filein</span><span class="op">)</span></span>
<span>  <span class="va">agregated_results</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data</span><span class="op">&lt;-</span><span class="fu">set_classes</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>   <span class="co"># for 4 classes</span></span>
<span>  <span class="co">#data[,ncol(data)]&lt;-floor(data[,ncol(data)])  # for 10 classes -- the scores 2.5 and 3.5 are floored</span></span>
<span>  </span>
<span>  <span class="va">data</span><span class="op">&lt;-</span><span class="fu">standardize_features</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">no_trials</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co">#for train-test split with percentage e.g. 70-30</span></span>
<span>    <span class="va">bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">percentage</span><span class="op">)</span><span class="op">)</span> <span class="co">#define % of training</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span>           <span class="co">#sample rows </span></span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">bound</span>, <span class="op">]</span>            </span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">(</span><span class="va">bound</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="co">#training</span></span>
<span>    <span class="va">X.tilde</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">X</span> <span class="op">&lt;-</span>  <span class="va">X.tilde</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">train_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">train_Y</span> <span class="op">&lt;-</span>  <span class="va">train</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">glm_coefficients</span><span class="op">&lt;-</span><span class="fu">fit_and_return_coefficients</span><span class="op">(</span><span class="va">train_X</span>, <span class="va">train_Y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#test</span></span>
<span>    <span class="va">test_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">test_Y</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">results</span><span class="op">&lt;-</span><span class="fu">test_model</span><span class="op">(</span><span class="va">glm_coefficients</span>, <span class="va">test_X</span>, <span class="va">test_Y</span><span class="op">)</span></span>
<span>    <span class="va">agregated_results</span><span class="op">&lt;-</span><span class="va">agregated_results</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Average results over trials</span></span>
<span>  <span class="va">aggregated_results</span> <span class="op">&lt;-</span> <span class="va">aggregated_results</span> <span class="op">/</span> <span class="va">no_trials</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">agregated_results</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSE"</span>, <span class="st">"RMSE"</span>, <span class="st">"MAE"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GLM2"</span>, <span class="st">"SR"</span>, <span class="st">"GSR"</span>, <span class="st">"St"</span>, <span class="st">"DSh"</span>, <span class="st">"Sh"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">fileout</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">input_file_path</span> <span class="op">&lt;-</span> <span class="st">"data_for_regression10.csv"</span></span>
<span><span class="va">output_file_path</span> <span class="op">&lt;-</span> <span class="st">"results10.csv"</span></span>
<span><span class="va">run_performance_test</span> <span class="op">&lt;-</span> <span class="fu">out_of_sample_performance</span><span class="op">(</span></span>
<span>  percentage <span class="op">=</span> <span class="fl">0.3</span>,        </span>
<span>  no_trials <span class="op">=</span> <span class="fl">50</span>,            </span>
<span>  filein <span class="op">=</span> <span class="va">input_file_path</span>,  </span>
<span>  fileout <span class="op">=</span> <span class="va">output_file_path</span> </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="portfolio-investment">Portfolio Investment<a class="anchor" aria-label="anchor" href="#portfolio-investment"></a>
</h3>
<p>This second example applies shrinkage methods to asset return data
for constructing optimal portfolios. We use the <code>returns_441</code>
dataset, included in the package under
<code>data/returns_441.rda</code>. The dataset consists of daily returns
for 441 stocks including the index, with <code>Date</code> formatted as
<code>YYYYMMDD</code>. For each rolling window, we:</p>
<ul>
<li><p>Fit multiple regression-based models (OLS, RR, POET_99%, St, DSh,
Sh, SR, GSR, SRR).</p></li>
<li><p>Extract the estimated coefficients and compute portfolio
weights.</p></li>
<li><p>Simulate out-of-sample portfolio performance.</p></li>
<li><p>Compute rolling statistics: expected annual returns, volatility,
and Sharpe ratios.</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Ziwei-ChenChen.github.io/savvySh">savvySh</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/braverock/PerformanceAnalytics" class="external-link">PerformanceAnalytics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">quadprog</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts" class="external-link">xts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">POET</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">returns_441</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y%m%d"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">442</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Company"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">441</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_size</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">252</span>  </span>
<span><span class="va">testing_size</span>  <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">21</span>  </span>
<span><span class="va">step_size</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">21</span>   </span>
<span><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">max_windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">n_total</span> <span class="op">-</span> <span class="va">training_size</span> <span class="op">-</span> <span class="va">testing_size</span><span class="op">)</span> <span class="op">/</span> <span class="va">step_size</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total rows:"</span>, <span class="va">n_total</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max windows:"</span>, <span class="va">max_windows</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_full_weights</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">est_vector</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="va">est_vector</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>      </span>
<span>  <span class="va">w_last</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>    </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">w_last</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poet_est_99</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">y_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">x_c</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x_mean</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">y_c</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">y_mean</span></span>
<span>  <span class="va">Y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x_c</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Choose K to explain 99% variance</span></span>
<span>  <span class="va">eigvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">x_c</span><span class="op">)</span>, symmetric <span class="op">=</span> <span class="cn">TRUE</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span>
<span>  <span class="va">eigvals_sorted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">eigvals</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">cumsum_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">eigvals_sorted</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">eigvals_sorted</span><span class="op">)</span></span>
<span>  <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">cumsum_vals</span> <span class="op">&gt;=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">poet_result</span> <span class="op">&lt;-</span> <span class="fu">POET</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/POET/man/POET.html" class="external-link">POET</a></span><span class="op">(</span><span class="va">Y</span>, K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span>
<span>  <span class="va">Sigma_hat</span> <span class="op">&lt;-</span> <span class="va">poet_result</span><span class="op">$</span><span class="va">SigmaY</span></span>
<span>  </span>
<span>  <span class="va">xcyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">x_c</span>, <span class="va">y_c</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span>
<span>  <span class="va">beta_1p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Sigma_hat</span>, <span class="va">xcyc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">beta_0</span> <span class="op">&lt;-</span> <span class="va">y_mean</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x_mean</span> <span class="op">*</span> <span class="va">beta_1p</span><span class="op">)</span></span>
<span>  <span class="va">beta_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta_0</span>, <span class="va">beta_1p</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">beta_full</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rolling_annual_expected_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rolling_annual_sharpe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rolling_annual_volatilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">window_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">max_windows</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">start_index</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">window_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">step_size</span></span>
<span>  <span class="va">train_start</span> <span class="op">&lt;-</span> <span class="va">start_index</span></span>
<span>  <span class="va">train_end</span> <span class="op">&lt;-</span> <span class="va">start_index</span> <span class="op">+</span> <span class="va">training_size</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">test_start</span> <span class="op">&lt;-</span> <span class="va">train_end</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="va">test_end</span> <span class="op">&lt;-</span> <span class="va">train_end</span> <span class="op">+</span> <span class="va">testing_size</span></span>
<span></span>
<span>  <span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">train_start</span><span class="op">:</span><span class="va">train_end</span>, <span class="op">]</span></span>
<span>  <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">test_start</span><span class="op">:</span><span class="va">test_end</span>, <span class="op">]</span></span>
<span>  <span class="va">train_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  </span>
<span>  <span class="va">test_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  </span>
<span>  </span>
<span>  <span class="co"># Create X_train and Y_train</span></span>
<span>  <span class="co"># Y_train is last column (Company441)</span></span>
<span>  <span class="co"># X_train is (Y_train - first 440 columns)</span></span>
<span>  <span class="va">Y_train</span> <span class="op">&lt;-</span> <span class="va">train_returns</span><span class="op">[</span>, <span class="fl">441</span><span class="op">]</span></span>
<span>  <span class="va">X_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Y_train</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train_returns</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">440</span><span class="op">)</span> <span class="op">-</span> <span class="va">train_returns</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">440</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Fit all estimators</span></span>
<span>  <span class="va">est_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    OLS <span class="op">=</span> <span class="fu">OLS_est</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span><span class="op">$</span><span class="va">est</span>,</span>
<span>    RR <span class="op">=</span> <span class="fu">RR_est</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span><span class="op">$</span><span class="va">est</span>,</span>
<span>    POET_99 <span class="op">=</span> <span class="fu">poet_est_99</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>,</span>
<span>    St <span class="op">=</span> <span class="fu">St_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>,</span>
<span>    DSh <span class="op">=</span> <span class="fu">DSh_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>,</span>
<span>    Sh <span class="op">=</span> <span class="fu">Sh_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>, </span>
<span>    SR <span class="op">=</span> <span class="fu">SR_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>,</span>
<span>    GSR <span class="op">=</span> <span class="fu">GSR_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span>,</span>
<span>    SRR <span class="op">=</span> <span class="fu">SRR_shrinkage_ost</span><span class="op">(</span><span class="va">X_train</span>, <span class="va">Y_train</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">weights_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">est_results</span>, <span class="va">get_full_weights</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">weights_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est_results</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">test_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span>  <span class="va">test_returns_xts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html" class="external-link">xts</a></span><span class="op">(</span><span class="va">test_returns</span>, order.by <span class="op">=</span> <span class="va">test_dates</span><span class="op">)</span></span>
<span>  <span class="va">daily_returns_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">weights_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/Return.portfolio.html" class="external-link">Return.portfolio</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">test_returns_xts</span>, weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rp</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">daily_values_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">daily_returns_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cum_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">r</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cum_val</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">model_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">daily_returns_list</span><span class="op">)</span></span>
<span>  <span class="va">n_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">test_start</span><span class="op">:</span><span class="va">test_end</span><span class="op">)</span></span>
<span>  <span class="va">daily_values_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_names</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">n_test</span><span class="op">)</span></span>
<span>  <span class="va">daily_returns_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_names</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">n_test</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">daily_values_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">model_names</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">daily_returns_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">model_names</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">model_names</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">daily_values_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">daily_values_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">daily_returns_mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">daily_returns_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">returns_xts_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html" class="external-link">xts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">daily_returns_mat</span><span class="op">)</span>, order.by <span class="op">=</span> <span class="va">test_dates</span><span class="op">)</span></span>
<span>  <span class="va">annual_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/Return.annualized.html" class="external-link">Return.annualized</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">returns_xts_mat</span>, scale <span class="op">=</span> <span class="fl">252</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annual_returns</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">returns_xts_mat</span><span class="op">)</span></span>
<span>  <span class="va">annual_vols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/StdDev.annualized.html" class="external-link">StdDev.annualized</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">returns_xts_mat</span>, scale <span class="op">=</span> <span class="fl">252</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annual_vols</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">returns_xts_mat</span><span class="op">)</span></span>
<span>  <span class="va">annual_sharp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/SharpeRatio.annualized.html" class="external-link">SharpeRatio.annualized</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">returns_xts_mat</span>, scale <span class="op">=</span> <span class="fl">252</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annual_sharp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">returns_xts_mat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">window_result_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">annual_returns</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">window_result_returns</span><span class="op">$</span><span class="va">Window</span> <span class="op">&lt;-</span> <span class="va">window_index</span></span>
<span>  <span class="va">rolling_annual_expected_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rolling_annual_expected_returns</span>, <span class="va">window_result_returns</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">window_result_sharpe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">annual_sharp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">window_result_sharpe</span><span class="op">$</span><span class="va">Window</span> <span class="op">&lt;-</span> <span class="va">window_index</span></span>
<span>  <span class="va">rolling_annual_sharpe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rolling_annual_sharpe_ratios</span>, <span class="va">window_result_sharpe</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">window_result_vols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">annual_vols</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">window_result_vols</span><span class="op">$</span><span class="va">Window</span> <span class="op">&lt;-</span> <span class="va">window_index</span></span>
<span>  <span class="va">rolling_annual_volatilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rolling_annual_volatilities</span>, <span class="va">window_result_vols</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Completed window"</span>, <span class="va">window_index</span>,</span>
<span>      <span class="st">": Training rows ["</span>, <span class="va">train_start</span>, <span class="st">"to"</span>, <span class="va">train_end</span>, </span>
<span>      <span class="st">"] (Dates:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, </span>
<span>      <span class="st">"to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span><span class="op">]</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, </span>
<span>      <span class="st">"), Testing rows ["</span>, <span class="va">test_start</span>, <span class="st">"to"</span>, <span class="va">test_end</span>, </span>
<span>      <span class="st">"] (Dates:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, </span>
<span>      <span class="st">"to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">Date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span><span class="op">]</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziwei Chen, Vali Asimit, Marina Anca Cidota, Jennifer Asimit.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
